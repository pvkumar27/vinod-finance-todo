# üè¶ v2.1.0 Plaid Integration Setup Guide

## Database Setup Required

**IMPORTANT**: Run this SQL script in your Supabase dashboard before using Plaid features.

### Step 1: Run SQL Setup

Go to your Supabase project ‚Üí SQL Editor ‚Üí Run this script:

```sql
-- Create plaid_tokens table for storing Plaid access tokens securely
CREATE TABLE IF NOT EXISTS plaid_tokens (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,
  access_token TEXT NOT NULL,
  item_id TEXT NOT NULL,
  institution_id TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  UNIQUE(user_id, item_id)
);

-- Add RLS policy for plaid_tokens
ALTER TABLE plaid_tokens ENABLE ROW LEVEL SECURITY;

-- Policy: Users can only see their own tokens
CREATE POLICY "Users can view their own plaid tokens" ON plaid_tokens
  FOR SELECT USING (auth.uid() = user_id);

-- Policy: Users can insert their own tokens
CREATE POLICY "Users can insert their own plaid tokens" ON plaid_tokens
  FOR INSERT WITH CHECK (auth.uid() = user_id);

-- Policy: Users can update their own tokens
CREATE POLICY "Users can update their own plaid tokens" ON plaid_tokens
  FOR UPDATE USING (auth.uid() = user_id);

-- Policy: Users can delete their own tokens
CREATE POLICY "Users can delete their own plaid tokens" ON plaid_tokens
  FOR DELETE USING (auth.uid() = user_id);

-- Add plaid_account_id column to credit_cards table for linking
ALTER TABLE credit_cards 
ADD COLUMN IF NOT EXISTS plaid_account_id TEXT;
```

### Step 2: Environment Variables

Add these to your `.env` file:

```env
# Plaid Configuration
REACT_APP_PLAID_CLIENT_ID=6877425451bb0300204d721c
REACT_APP_PLAID_SECRET=dcccb531a05ca0e5feb4547e40fbc1
REACT_APP_PLAID_ENV=development
```

### Step 3: Plaid Credentials

**Important**: Use the "Sandbox 1" key from your Plaid dashboard - despite the name, this is actually for the development environment.

**Your .env should look like:**
```env
REACT_APP_PLAID_CLIENT_ID=6877425451bb0300204d721c
REACT_APP_PLAID_SECRET=your_sandbox_1_key_from_dashboard
REACT_APP_PLAID_ENV=development
```

## What's New in v2.1.0

### üè¶ Plaid Integration
- **Connect Bank Account**: New button in Credit Cards section
- **Auto-Import**: Credit card metadata automatically synced
- **Visual Indicators**: üè¶ Plaid Synced badges on connected cards
- **Secure Storage**: Tokens stored safely in Supabase

### üé® UI Improvements
- **Form Labels**: Owner and Source fields now have clear labels
- **Loading States**: Smooth experience during bank connection
- **Success Messages**: Clear feedback when sync completes

### üîí Security Features
- **User Isolation**: Each user's Plaid tokens are private
- **No Sensitive Data**: Only card metadata synced (no transactions yet)
- **Environment Variables**: Credentials managed securely

## How to Use

1. Go to Credit Cards section
2. Click "üè¶ Connect Bank Account"
3. Follow Plaid Link flow to connect your bank
4. Credit cards will automatically appear with Plaid badges

## Development Environment Only

This project uses Plaid's development environment exclusively:
- Real bank connections (free tier)
- Single user limit perfect for personal use
- Backend API endpoints required for security
- No sandbox or production modes to simplify setup

## Troubleshooting

- **Button not working**: Check environment variables are set
- **No cards synced**: Verify Supabase connection and RLS policies
- **Database errors**: Ensure SQL script ran successfully

---

**Release Date**: January 16, 2025  
**Version**: v2.1.0  
**Database Migration**: Required